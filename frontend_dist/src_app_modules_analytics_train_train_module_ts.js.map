{"version":3,"file":"src_app_modules_analytics_train_train_module_ts.js","mappings":"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","sources":["./src/app/modules/analytics/train/train-routing.module.ts","./src/app/modules/analytics/train/train.module.ts","./src/app/modules/analytics/train/train.page.ts","./src/app/modules/analytics/train/train.page.html"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { TrainPage } from './train.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: TrainPage,\r\n\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class TrainPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { TrainPageRoutingModule } from './train-routing.module';\r\n\r\nimport { TrainPage } from './train.page';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    TrainPageRoutingModule,\r\n    TranslateModule.forChild({\r\n      extend: true,\r\n    }),\r\n  ],\r\n  declarations: [TrainPage]\r\n})\r\nexport class TrainPageModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { EntityActionFactory, EntityOp } from '@ngrx/data';\r\nimport { Store } from '@ngrx/store';\r\nimport { from, Observable } from 'rxjs';\r\nimport { map, withLatestFrom } from 'rxjs/operators';\r\nimport { IGame, IGamer, IUser } from 'src/app/interfaces';\r\nimport * as fromAnalyticsActions from 'src/app/store/actions/analytics.actions';\r\nimport { GameService } from 'src/app/store/game-data.service';\r\nimport { GamerService } from 'src/app/store/gamer-data.service';\r\nimport { selectRating, selectLoading } from 'src/app/store/reducers/analytics.reducer';\r\n\r\nimport { environment } from 'src/environments/environment';\r\n\r\n@Component({\r\n  selector: 'app-train',\r\n  templateUrl: './train.page.html',\r\n  styleUrls: ['./train.page.scss'],\r\n})\r\nexport class TrainPage implements OnInit {\r\n  players: IGamer[];\r\n  analytics$: Observable<IGamer[]>;\r\n  loading$: Observable<boolean>;\r\n  stats = environment.games.train.stats;\r\n  stat: any = this.stats[0];\r\n  math = Math;\r\n  array = Array;\r\n\r\n  games$: Observable<IGame[]>;\r\n  gamers$: Observable<IGamer[]>;\r\n\r\n  constructor(\r\n    private store: Store,\r\n    private gameService: GameService,\r\n    private gamerService: GamerService,\r\n    private entityActionFactory: EntityActionFactory,\r\n  ) { }\r\n\r\n  ionViewWillEnter() {\r\n    console.log('view')\r\n    this.store.dispatch(fromAnalyticsActions[this.stats[0]._id]({ gameType: 'train' }));\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.games$ = this.gameService.entities$;\r\n    this.games$\r\n      .subscribe(() =>\r\n        this.store.dispatch(fromAnalyticsActions[this.stat._id]({ gameType: 'train' }))\r\n      );\r\n\r\n    this.gamers$ = this.gamerService.entities$;\r\n    this.gamers$.subscribe((x) => console.log('gamers', x))\r\n\r\n\r\n    console.log('[this.stats[0]._id', this.stats[0]._id);\r\n    // this.store.dispatch(fromAnalyticsActions[this.stats[0]._id]({ gameType: 'train' }));\r\n    this.analytics$ = this.store.select(selectRating);\r\n    // this.analytics$.pipe(\r\n    //   withLatestFrom(this.gamers$),\r\n    //   map((x) => {\r\n    //     this.store.dispatch(fromAnalyticsActions.addMany({analytics: x[1]}))\r\n    //     console.log('an0', x)\r\n    //   })\r\n    // )\r\n    //   .subscribe((x) => console.log('an', x))\r\n\r\n    this.loading$ = this.store.select(selectLoading);\r\n  }\r\n\r\n  onMenuClickHandler(e: any) {\r\n    this.stat = e.target.value;\r\n    this.store.dispatch(fromAnalyticsActions[this.stat._id]({ gameType: 'train' }));\r\n  }\r\n}\r\n","export default \"<ion-header>\\r\\n  <ion-toolbar>\\r\\n    <!-- <ion-title>Train analytics</ion-title> -->\\r\\n\\r\\n    <ion-buttons slot=\\\"end\\\">\\r\\n      <ion-menu-button menu=\\\"analytics-menu\\\"></ion-menu-button>\\r\\n    </ion-buttons>\\r\\n    <ion-segment [value]=\\\"stats[0]\\\" (ionChange)=\\\"onMenuClickHandler($event)\\\">\\r\\n      <ion-segment-button *ngFor=\\\"let stat of stats; let idx = index\\\" [value]=\\\"stat\\\">\\r\\n        <ion-icon [name]=\\\"stat.icon\\\"></ion-icon>\\r\\n      </ion-segment-button>\\r\\n    </ion-segment>\\r\\n\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content>\\r\\n  <ion-grid class=\\\"ion-no-margin ion-no-padding\\\">\\r\\n    <ion-row>\\r\\n      <ion-col size-lg=\\\"6\\\" size-md=\\\"8\\\" size-sm=\\\"10\\\" offset-lg=\\\"3\\\" offset-md=\\\"2\\\" offset-sm=\\\"1\\\">\\r\\n        <ion-card>\\r\\n          <ion-card-header>\\r\\n            <ion-card-title class=\\\"ion-text-center\\\">Ticket to ride</ion-card-title>\\r\\n            <ion-card-subtitle class=\\\"ion-text-center\\\">{{'modules.analytics.' + stat.name | translate}}\\r\\n            </ion-card-subtitle>\\r\\n          </ion-card-header>\\r\\n          <ion-card-content>\\r\\n            <ion-list *ngIf=\\\"(loading$ | async) === true\\\">\\r\\n              <ion-item lines=\\\"none\\\" *ngFor=\\\"let x of array(5).fill('')\\\">\\r\\n                <ion-skeleton-text slot=\\\"start\\\" animated style=\\\"width: 60%\\\">\\r\\n                </ion-skeleton-text>\\r\\n                <ion-skeleton-text slot=\\\"end\\\" animated>\\r\\n                </ion-skeleton-text>\\r\\n              </ion-item>\\r\\n\\r\\n            </ion-list>\\r\\n\\r\\n            <ion-list *ngIf=\\\"(loading$ | async) === false\\\">\\r\\n              <ion-item *ngFor=\\\"let player of (analytics$ | async); let idx = index\\\">\\r\\n                <div slot=\\\"start\\\" [ngStyle]=\\\"{\\r\\n                  'border-right': '6px solid ' + player.color,\\r\\n                  'padding-right': '10px'\\r\\n                }\\\">{{idx+1}}</div>\\r\\n                <ion-label>\\r\\n                  {{player.name}}\\r\\n                </ion-label>\\r\\n                <ion-text *ngIf=\\\"stat._id === 'getRatingByWins'\\\" slot=\\\"end\\\" color=\\\"primary\\\">\\r\\n                  {{player.rating.wins}}\\r\\n                </ion-text>\\r\\n                <ion-text *ngIf=\\\"stat._id === 'getRatingByWinsToGames'\\\" slot=\\\"end\\\" color=\\\"primary\\\">\\r\\n\\r\\n                  {{player.rating.wins}} / {{player.rating.gamesCount}}\\r\\n                  <ion-text class=\\\"bold\\\">( {{player.rating.wins ? math.floor(player.rating.winsToGames * 100) : 0}}% )\\r\\n                  </ion-text>\\r\\n\\r\\n                </ion-text>\\r\\n              </ion-item>\\r\\n            </ion-list>\\r\\n            <!-- <ion-row class=\\\"ion-justify-content-around\\\">\\r\\n              <ion-button fill=\\\"outline\\\" size=\\\"small\\\" [disabled]=\\\"(rounds$ | async).length === 0\\\"\\r\\n                (click)=\\\"onFinishGameHandler()\\\">\\r\\n                {{'elements.button.finishGame' | translate}}\\r\\n              </ion-button>\\r\\n              <ion-button fill=\\\"outline\\\" size=\\\"small\\\" [disabled]=\\\"(rounds$ | async).length === 0\\\"\\r\\n                (click)=\\\"onCancelGameHandler()\\\">\\r\\n                {{'elements.button.cancelGame' | translate}}\\r\\n              </ion-button> -->\\r\\n          </ion-card-content>\\r\\n        </ion-card>\\r\\n\\r\\n      </ion-col>\\r\\n    </ion-row>\\r\\n  </ion-grid>\\r\\n</ion-content>\";"],"names":[],"sourceRoot":"webpack:///"}